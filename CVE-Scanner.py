import socket
import nmap
import requests
import ipaddress

from bs4 import BeautifulSoup


# def check_cve(version):
#    url = f"https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword={version}"
#    res = requests.get(url)
#    soup = BeautifulSoup(res.text, "html.parser")
#    if "No matching CVE" in soup.text:
#        return None
#    else:
#        cves = [a.text for a in soup.select("td > a")]
#        return cves

def scan_ports(ip):
    nm = nmap.PortScanner()
    nm.scan(ip, arguments="-sS -T4")
    open_ports = []
    for port in nm[ip]['tcp']:
        if nm[ip]['tcp'][port]['state'] == 'open':
            open_ports.append(port)
    return open_ports


def url_to_ip(ip):
    try:
        ipaddress.ip_address(string)
        return ip
    except ValueError:
        return socket.gethostbyname(ip)


def main():
    ip = input("Enter the IP address to scan: ")
    ip = url_to_ip(ip)
    ports = scan_ports(ip)
    print(f"Open ports on {ip}: {ports}")
    for port in ports:
        return port


main()
